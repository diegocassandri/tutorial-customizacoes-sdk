{"changed":true,"filter":false,"title":"userRolesService.js","tooltip":"/2oRcurVwM6Wk-platform-user-updateUser/src/services/userRolesService.js","value":"//Importa as blibliotecas momonent,axios e o utilizario http da biblioteca fab-lambda-lib\nconst AxiosWrapper = require('fab-lambda-lib').AxiosWrapper;\nconst axiosW = new AxiosWrapper(require('axios').default);\n\n//recebdo o event e o nome do usuário que está sendo alterado\nasync function validateRoles(event, user) {\n    \n    //armazena o resutado do métdo que busca os perfis do usuário\n    let userRoles = await findRoles(event,user);\n    \n    //percorre e filtra os perfis retornando apenas os que possuem nome como admin\n    userRoles = userRoles.roles.filter(role => {\n        return role.name === 'admin';\n    }); \n    \n    //se o array possuir valores quer dizer que o usuário está no grupo admin\n    if(userRoles.length !== 0){\n       return true;\n    }\n    \n    //caso contrário devolde false\n    return false;\n}\n\nfunction findRoles (event, user) {\n   //realiza a chamada http para a plataforma, passando como parâmetro a utl, event e o nome do usuário no corpo da requisição\n    return axiosW.platformPost('/platform/authorization/queries/getUserDetailRoles',event, {user});\n}\n\nmodule.exports = {\n    validateRoles\n};","undoManager":{"mark":0,"position":1,"stack":[[{"start":{"row":1,"column":0},"end":{"row":2,"column":58},"action":"remove","lines":["const AxiosWrapper = require('fab-lambda-lib').AxiosWrapper;","const axiosW = new AxiosWrapper(require('axios').default);"],"id":2},{"start":{"row":1,"column":0},"end":{"row":1,"column":67},"action":"insert","lines":["const { axiosW } = require('@seniorsistemas/fsw-aws-lambda/utils');"]}],[{"start":{"row":30,"column":2},"end":{"row":31,"column":0},"action":"insert","lines":["",""],"id":3}]]},"ace":{"folds":[],"customSyntax":"javascript","scrolltop":0,"scrollleft":0,"selection":{"start":{"row":31,"column":0},"end":{"row":31,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1574803944822}